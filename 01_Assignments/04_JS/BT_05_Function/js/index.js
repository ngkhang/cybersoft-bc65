// Validate input
function validate(input, fieldName = '') {
  let status = false;
  let mess = '';

  if (input === '')
    mess = `Vui l√≤ng nh·∫≠p ${fieldName}`;
  else if (Number.isNaN(input * 1))
    mess = `${fieldName} kh√¥ng h·ª£p l·ªá`;
  else status = true;

  return {
    status,
    mess,
  };
}

// Reset all input
function resetAll(resultId) {
  const inputs = document.getElementsByTagName('input');

  resultId.innerHTML = 'üëâ K·∫øt qu·∫£...';
  resultId.classList.remove('resultSuccess', 'resultError');
  resultId.classList.add('resultPedding');

  [...inputs].forEach((input) => input.value = '');
}

// Fake loading
function fakeLoading(exrciseId) {
  const spinnerId = document.getElementById('spinner');
  spinnerId.classList.remove('d-none');
  spinnerId.classList.add('d-flex');

  let timerId = setTimeout(() => {
    spinnerId.classList.remove('d-flex');
    spinnerId.classList.add('d-none');
    exrciseId.classList.remove('d-none')
  }, 300);
}

// Handle Submit with Enter keyboard
function handleEnter(event, exerciseId) {
  if (event.keyCode === 13) {
    switch (exerciseId) {
      case 'exercise01':
        sortThreeNumber();
        break;
      case 'exercise02':
        greeting();
        break;
      case 'exercise03':
        filterNumber();
        break;
      default:
        getTypeTriangle();
        break;
    }
  };
}

// Handle Change Exercise
function handleChangeExercise(exerciseId) {
  const ID = exerciseId.slice(-1);
  const exerciseID = document.getElementById(exerciseId);
  const listExercise = document.getElementsByClassName('exercise');
  const listBtnExercise = document.getElementsByClassName('btn-exercise');
  const resultId = document.getElementById(`result_exercise_0${ID}`);

  resetAll(resultId);

  [...listBtnExercise].forEach((ele, index) => {
    (index === ID - 1)
      ? ele.classList.add('active')
      : ele.classList.remove('active');
  });

  [...listExercise].forEach((ele) => {
    ele.classList.add('d-none');
  });

  fakeLoading(exerciseID);
}

// BT 01 - S·∫Øp x·∫øp 3 s·ªë tƒÉng d·∫ßn
function sortThreeNumber() {
  const numbers = document.querySelectorAll('#exercise01 input');
  const resultID = document.getElementById('result_exercise_01');

  resultID.classList.remove('resultPedding', 'resultError', 'resultSuccess');

  const arrNumber = [...numbers];
  const arr = [];
  let output;
  for (let i = 0; i < arrNumber.length; i++) {
    let number = arrNumber[i].value;
    let numberValid = validate(number, `S·ªë th·ª© ${i + 1}`);

    if (!numberValid.status || !Number.isInteger(number * 1)) {
      output = numberValid.mess || `S·ªë th·ª© ${i + 1} kh√¥ng l√† s·ªë nguy√™n`;
      break;
    }
    arr.push(number * 1);
  }

  if (output === undefined) {
    arr.sort((a, b) => a - b);
    output = `üëâ Th·ª© t·ª± tƒÉng d·∫ßn: ${arr.join(', ')}`;
  }

  resultID.classList.add(`${(output.startsWith('üëâ')) ? 'resultSuccess' : 'resultError'}`);
  resultID.innerHTML = output;
}

// BT 02 - Ch√†o h·ªèi th√†nh vi√™n trong nh√†
function greeting() {
  const userId = document.getElementById('user');
  let userVal = userId.value.toLowerCase();
  const resultID = document.getElementById('result_exercise_02');

  resultID.classList.remove('resultPedding', 'resultError', 'resultSuccess');

  let output;
  switch (userVal) {
    case 'ba':
    case 'b':
      output = 'üëâ Th·∫ø gi·ªõi c√≥ g√¨ m·ªõi? c√πng kh√°m ph√° n√†o';
      break;
    case 'm·∫π':
    case 'm':
      output = 'üëâ M√πa sales ƒë√£ t·ªõi, c√πng s·∫Øm ƒë·ªì th√¥i';
      break;
    case 'anh trai':
    case 'a':
      output = 'üëâ C√πng chi·∫øn game th√¥i n√†o';
      break;
    case 'em g√°i':
    case 'e':
      output = 'üëâ Kpop c√≥ tin t·ª©c m·ªõi, xem nhanh n√†o';
      break;
    case '':
      output = 'Vui l√≤ng kh√¥ng b·ªè tr·ªëng';
      break;
    default:
      output = 'Vui l√≤ng nh·∫≠p ƒë√∫ng ƒë·ªãnh d·∫°ng';
      break;
  }

  resultID.classList.add(`${(output.startsWith('üëâ')) ? 'resultSuccess' : 'resultError'}`);
  resultID.innerHTML = output;
}

// BT 03 - ƒê·∫øm s·ªë s·ªë l·∫ª v√† s·ªë s·ªë ch·∫≥n
function filterNumber() {
  const numbers = document.querySelectorAll('#exercise03 input');
  const resultID = document.getElementById('result_exercise_03');

  resultID.classList.remove('resultPedding', 'resultError', 'resultSuccess');

  const arrNumber = [...numbers];
  let output;
  let oddNumber = 0;
  let evenNumber = 0;
  for (let i = 0; i < arrNumber.length; i++) {
    let number = arrNumber[i].value;
    let numberValid = validate(number, `S·ªë th·ª© ${i + 1}`);

    if (!numberValid.status || !Number.isInteger(number * 1)) {
      output = numberValid.mess || `S·ªë th·ª© ${i + 1} kh√¥ng l√† s·ªë nguy√™n`;
      break;
    }
  }

  if (output === undefined) {
    for (let i = 0; i < arrNumber.length; i++) {
      let number = arrNumber[i].value;
      (number * 1 % 2 === 0)
        ? evenNumber++
        : oddNumber++
    }

    output = `üëâ S·ªë s·ªë l·∫ª: ${oddNumber}. S·ªë s·ªë ch·∫≥n: ${evenNumber}`;
  }

  resultID.classList.add(`${(output.startsWith('üëâ')) ? 'resultSuccess' : 'resultError'}`);
  resultID.innerHTML = output;
}

// BT 04 - X√°c ƒë·ªãnh lo·∫°i tam gi√°c
function getTypeTriangle() {
  const numbers = document.querySelectorAll('#exercise04 input');

  const resultID = document.getElementById('result_exercise_04');

  resultID.classList.remove('resultPedding', 'resultError', 'resultSuccess');

  const arrNumber = [...numbers];
  let output;
  let sides = [];
  for (let i = 0; i < arrNumber.length; i++) {
    let number = arrNumber[i].value;
    let numberValid = validate(number, `C·∫°nh th·ª© ${i + 1}`);

    if (!numberValid.status) {
      output = numberValid.mess;
      break;
    }
    sides[i] = number * 1;
  }

  if (output === undefined) {
    if ((sides[0] + sides[1] <= sides[2])
      || (sides[0] + sides[2] <= sides[1])
      || (sides[1] + sides[2] <= sides[0])) {

      output = 'Kh√¥ng ph·∫£i l√† tam gi√°c';
    }
    else if (sides[0] === sides[1]
      || sides[0] === sides[2]
      || sides[1] === sides[2]) {
      output = 'üëâ Tam gi√°c c√¢n';
    }
    else if (sides[0] === sides[1] === sides[2]) {
      output = 'üëâ Tam gi√°c ƒë·ªÅu';
    }
    else if (sides[0] ** 2 + sides[1] ** 2 === sides[2] ** 2
      || sides[0] ** 2 + sides[2] ** 2 === sides[1] ** 2
      || sides[1] ** 2 + sides[2] ** 2 === sides[0] ** 2) {
      output = 'üëâ Tam gi√°c vu√¥ng';
    } else output = 'üëâ Tam gi√°c th∆∞·ªùng';
  }
  console.log(output);

  resultID.classList.add(`${(output.startsWith('üëâ')) ? 'resultSuccess' : 'resultError'}`);
  resultID.innerHTML = output;
}

function isEmpty(input) {
  let status = true;
  let mess = '';

  if (input === '') {
    mess = `Vui l√≤ng nh·∫≠p ${fieldName}`;
    status = false;
  }

  return {
    mess,
    status,
  };
}

function isNumber(input, option = 'Int') {
  let status = true;
  let mess = '';

  if (Number.isNaN(input * 1)) {
    mess = `${fieldName} kh√¥ng ph·∫£i l√† s·ªë`;
    status = false;
  }
  else if (option === 'Int' && !Number.isInteger(input * 1)) {
    mess = `${fieldName} kh√¥ng ph·∫£i l√† s·ªë nguy√™n`;
    status = false;
  }


  return {
    mess,
    status,
  };
}


// BT 01 - Qu·∫£n l√Ω tuy·ªÉn sinh
function printResult() {
  const KHU_VUC = {
    "A": 2,
    "B": 1,
    "C": 0.5,
    "X": 0,
  };

  const DOI_TUONG = {
    1: 2.5,
    2: 1.5,
    3: 1,
    0: 0,
  };

  const GRADE_BASE = 28;
  let a = 4;
  let b = 10;
  let c = 8;
  let khuvuc = 'B';
  let doituong = 1;

  let totalThree = a + b + c;
  let result = '';

  let areaGrade = KHU_VUC[khuvuc];
  let objectGrade = DOI_TUONG[doituong];
  let totalGrade = areaGrade + objectGrade + totalThree;

  if (a <= 0 || b <= 0 || c <= 0) {
    result = `T·ªïng ƒëi·ªÉm: ${totalGrade} - K·∫øt qu·∫£: R·ªõt`;
  }
  else if (totalGrade >= GRADE_BASE) result = `T·ªïng ƒëi·ªÉm: ${totalGrade} - K·∫øt qu·∫£: ƒê·∫≠u`;
  else result = `T·ªïng ƒëi·ªÉm: ${totalGrade} - K·∫øt qu·∫£: R·ªõt`;

  console.log(result);
  return result;
}

// BT 02 - T√≠nh ti·ªÅn ƒëi·ªán
function calculatorEng() {
  let userName = 'BAS';
  let countKw = 45.6;
  const LEVEL = {
    1: {
      range: 50,
      price: 500,
    },
    2: {
      range: 50,
      price: 650,
    },
    3: {
      range: 100,
      price: 850,
    },
    4: {
      range: 150,
      price: 1100,
    },
    5: {
      range: Infinity,
      price: 1300,
    },
  }

  let step = 1;
  let price = 0;

  while (countKw !== 0) {
    let levelCurrent = LEVEL[step];

    if (countKw > levelCurrent.range) {
      price += levelCurrent.range * levelCurrent.price;
      countKw = countKw - levelCurrent.range;
      step++;
    }
    else {
      price += countKw * levelCurrent.price;
      countKw = 0;
    }
  };
  return price;
}

// BT 03 - T√≠nh ti·ªÅn thu·∫ø thu nh·∫≠p c√° nh√¢n
function calculatorTax() {
  const LEVEL_TAX = {
    1: {
      range: 60,
      percent: 0.05,
    },
    2: {
      range: 120,
      percent: 0.10,
    },
    3: {
      range: 210,
      percent: 0.15,
    },
    4: {
      range: 384,
      percent: 0.2,
    },
    5: {
      range: 624,
      percent: 0.25,
    },
    6: {
      range: 960,
      percent: 0.3,
    },
    7: {
      range: Infinity,
      percent: 0.35,
    },
  };

  const PRICE_TAX = 4_000_000;
  const PRICE_PERSON = 1_600_000;
  let fullName = 'Nguyen Van A';
  let totalSalary = 90_000_000;
  let person = 2;

  let cost = totalSalary - PRICE_TAX - person * PRICE_PERSON;
  console.log(cost * 0.1);


}
// 8,280,000


// BT 04 - T√≠nh ti·ªÅn c√°p
function calculatorCable() {
  const TYPE_CUSTOMER = {
    'Nh√† d√¢n': {
      costBase: 4.5,
      costStandard: {
        basic: 20.5,
        bonus: 0,
      },
      costChannel: {
        count: 1,
        price: 7.5,
      },
    },
    'Doanh nghi·ªáp': {
      costBase: 15,
      costStandard: {
        basic: 75,
        bonus: 5,
      },
      costChannel: {
        count: 1,
        price: 50,
      },
    },
  };

  let codeCustomer = 'ABC123';
  let typeCustomer = 'Doanh nghi·ªáp';
  let connects = 15;
  let channels = 80;

  let priceBase = TYPE_CUSTOMER[typeCustomer].costBase;
  let priceChannel = channels * TYPE_CUSTOMER[typeCustomer].costChannel.count * TYPE_CUSTOMER[typeCustomer].costChannel.price;
  let priceConnect = (connects > 10) ? (connects - 10) * TYPE_CUSTOMER[typeCustomer].costStandard.bonus + TYPE_CUSTOMER[typeCustomer].costStandard.basic : connects * TYPE_CUSTOMER[typeCustomer].costStandard.basic;

  let totalPrice = priceBase + priceChannel + priceConnect;

  console.log(totalPrice);
  return totalPrice;
}
// 4115
